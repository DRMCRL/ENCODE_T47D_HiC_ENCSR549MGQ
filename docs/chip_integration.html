<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Stephen Pederson Dame Roma Mitchell Cancer Research Laboratories Adelaide Medical School University of Adelaide" />


<title>Integration of HiC and Super Enhancer Data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ENCODE_T47D_HiC_ENCSR549MGQ</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="description.html">Workflow Description</a>
</li>
<li>
  <a href="annotation_setup.html">Annotations</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Interactions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="interactions_setup.html">Setup</a>
    </li>
    <li>
      <a href="interactions_40kb.html">40kb Interactions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Super Enhancers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="rose.html">ROSE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Integration of HiC and Super Enhancer Data</h1>
<h4 class="author">Stephen Pederson<br>Dame Roma Mitchell Cancer Research Laboratories<br>Adelaide Medical School<br>University of Adelaide</h4>
<h4 class="date">27 November, 2020</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2020-11-27
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>ENCODE_T47D_HiC_ENCSR549MGQ/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.2). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200918code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20200918)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200918code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200918)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomDRMCRLENCODET47DHiCENCSR549MGQtreed9254d6a49c66195a1d1cd049fa71ca50cdbbb34targetblankd9254d6a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/tree/d9254d6a49c66195a1d1cd049fa71ca50cdbbb34" target="_blank">d9254d6</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomDRMCRLENCODET47DHiCENCSR549MGQtreed9254d6a49c66195a1d1cd049fa71ca50cdbbb34targetblankd9254d6a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility.
</p>
<p>
The results in this page were generated with repository version <a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/tree/d9254d6a49c66195a1d1cd049fa71ca50cdbbb34" target="_blank">d9254d6</a>. See the <em>Past versions</em> tab to see a history of the changes made to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    .snakemake/
    Ignored:    data/external/AR/bigwig/
    Ignored:    data/external/GATA3/bigwig/
    Ignored:    data/external/H3K27AC/bam/
    Ignored:    data/external/H3K27AC/bigwig/
    Ignored:    data/external/gencode.v33lift37.annotation.gtf.gz
    Ignored:    output/MaxHiC/

Untracked files:
    Untracked:  data/external/GATA3/.access^

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were made to the R Markdown (<code>analysis/chip_integration.Rmd</code>) and HTML (<code>docs/chip_integration.html</code>) files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/d9254d6a49c66195a1d1cd049fa71ca50cdbbb34/analysis/chip_integration.Rmd" target="_blank">d9254d6</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-27
</td>
<td>
Finished looking at DE genes with a GATA3 gain but no AR gain in the promoter
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/analysis/chip_integration.Rmd" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
<td>
Finished exploration of GATA unique peaks which overlap promoters. Groups need to be redefined.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/chip_integration.html" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
<td>
Finished exploration of GATA unique peaks which overlap promoters. Groups need to be redefined.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/bb0397c044aee699ee18061cea70166232cfac3c/docs/chip_integration.html" target="_blank">bb0397c</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/8a4164427459a0d50595c3ddb90dd12dfaabf361/analysis/chip_integration.Rmd" target="_blank">8a41644</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
<td>
Corrected plot for RANBP3L
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/eb8d7988a8f408b7307baefb859e1e0a1d6f1f82/docs/chip_integration.html" target="_blank">eb8d798</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4d8bb28af207aae0825b5d31a3387f8377d7429c/analysis/chip_integration.Rmd" target="_blank">4d8bb28</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
<td>
Added more DE genes
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/e120d5420b7952e0b78fa9f622d985b23d3b5857/analysis/chip_integration.Rmd" target="_blank">e120d54</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-25
</td>
<td>
Pushed on with ChIP Integration
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/e120d5420b7952e0b78fa9f622d985b23d3b5857/docs/chip_integration.html" target="_blank">e120d54</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-25
</td>
<td>
Pushed on with ChIP Integration
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/bb2628415634f3891e42653174483da42150e7af/analysis/chip_integration.Rmd" target="_blank">bb26284</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-23
</td>
<td>
Started integrating Leila’s data
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<pre class="r"><code>library(rtracklayer)
library(tidyverse)
library(Gviz)
library(glue)
library(Rsamtools)
library(pander)
library(scales)
library(GenomicInteractions)
library(InteractionSet)
library(magrittr)
library(plyranges)
library(goseq)</code></pre>
<pre class="r"><code>theme_set(theme_bw())
panderOptions(&quot;big.mark&quot;, &quot;,&quot;)
panderOptions(&quot;table.split.table&quot;, Inf)
nc &lt;- ceiling(detectCores()/2)</code></pre>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="data-description" class="section level2">
<h2>Data Description</h2>
<p>Given the groups of peaks identified by Leila Hosseinzadeh, using ChIP-Seq from both GATA3 and the AR, the connection of these peaks to enhancers, promoters and DE genes was explored. The groupings were provided as:</p>
<ol style="list-style-type: decimal">
<li>GATA3 sites detected under DHT treatment only</li>
<li>Shared sites between GATA3 and AR which are gained under DHT treatment</li>
<li>AR sites which were independent of DHT treatment</li>
<li>AR sites detected under DHT treatment only …</li>
</ol>
<p>Groups defining the relationship between AR and GATA3 at each peak were specified in the following files.</p>
<pre class="r"><code>groupBed &lt;- here::here(&quot;data/external/BED/AR_GATA3_Groups&quot;) %&gt;%
  list.files(full.names = TRUE, pattern = &quot;bed&quot;)
groupBed %&gt;%
  basename() %&gt;%
  enframe(name = c(), value = &quot;filename&quot;) %&gt;%
  rename_all(str_to_title) %&gt;%
  pander(
    justify = &quot;l&quot;,
    caption = &quot;List of `.bed` files containing peaks for each of the defined groups&quot;
  )</code></pre>
<table style="width:67%;">
<caption>List of <code>.bed</code> files containing peaks for each of the defined groups</caption>
<colgroup>
<col width="66%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Filename</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Galaxy279-[T47D-AR-DHT-ONLY].bed</td>
</tr>
<tr class="even">
<td align="left">Galaxy280-[T47D-GATA3-DHT-ONLY].bed</td>
</tr>
<tr class="odd">
<td align="left">Galaxy281-[T47D-AR-GATA3-DHT-Common].bed</td>
</tr>
<tr class="even">
<td align="left">Galaxy283-[T47D-DHT-induced-GATA3-unique].bed</td>
</tr>
<tr class="odd">
<td align="left">Galaxy284-[T47D-Common-AR-independent].bed</td>
</tr>
<tr class="even">
<td align="left">Galaxy285-[T47D-Common-AR-dependent].bed</td>
</tr>
</tbody>
</table>
<p>These groups were defined from consensus peaks within each treatment across replicates. The bed files associated with these treatment-specific consensus sites were all obtained using Galaxy as part of her PhD candidature. Files used for generation of consensus peaks are given in the table below.</p>
<pre class="r"><code>chipBed &lt;- here::here(&quot;data/external&quot;) %&gt;%
  list.files(full.names = TRUE, pattern = &quot;bed&quot;, recursive = TRUE) %&gt;%
  str_subset(&quot;ChromHMM|Groups&quot;, TRUE)</code></pre>
<pre class="r"><code>chipBed %&gt;%
  basename() %&gt;%
  enframe(name = c(), value = &quot;filename&quot;) %&gt;%
  mutate(
    `Cell Type` = str_extract(filename, &quot;T47D&quot;),
    target = str_extract(filename, &quot;AR|GATA3|H3K27Ac&quot;),
    treatment = case_when(
      str_detect(filename, &quot;E2_DHT&quot;) ~ &quot;E2+DHT&quot;,
      str_detect(filename, &quot;E2&quot;) ~ &quot;E2&quot;
    )
  ) %&gt;%
  arrange(target, treatment) %&gt;%
  rename_all(str_to_title) %&gt;%
  pander(
    justify = &quot;llll&quot;,
    caption = &quot;Description of `.bed` files used for defining consensus peaks.&quot;
  )</code></pre>
<table>
<caption>Description of <code>.bed</code> files used for defining consensus peaks.</caption>
<colgroup>
<col width="55%" />
<col width="15%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Filename</th>
<th align="left">Cell Type</th>
<th align="left">Target</th>
<th align="left">Treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Consensus_T47D_AR_E2_peaks_only.bed</td>
<td align="left">T47D</td>
<td align="left">AR</td>
<td align="left">E2</td>
</tr>
<tr class="even">
<td align="left">Consensus_T47D_AR_E2_DHT_peaks.bed</td>
<td align="left">T47D</td>
<td align="left">AR</td>
<td align="left">E2+DHT</td>
</tr>
<tr class="odd">
<td align="left">Galaxy67-[T47D-GATA3-E2].bed</td>
<td align="left">T47D</td>
<td align="left">GATA3</td>
<td align="left">E2</td>
</tr>
<tr class="even">
<td align="left">Galaxy69-[T47D-GATA3-E2_DHT].bed</td>
<td align="left">T47D</td>
<td align="left">GATA3</td>
<td align="left">E2+DHT</td>
</tr>
<tr class="odd">
<td align="left">Consensus_T47D_H3K27Ac_E2_peaks.bed</td>
<td align="left">T47D</td>
<td align="left">H3K27Ac</td>
<td align="left">E2</td>
</tr>
<tr class="even">
<td align="left">Consensus_T47D_H3K27Ac_E2_DHT_peaks.bed</td>
<td align="left">T47D</td>
<td align="left">H3K27Ac</td>
<td align="left">E2+DHT</td>
</tr>
</tbody>
</table>
</div>
<div id="external-data" class="section level2">
<h2>External data</h2>
<p><strong>ENCODE HiC data</strong> for T47D cells was analysed as part of the workflow. Significant interactions were detected using bins of 10, 20, 40 and 100kb.</p>
<p><strong>RNASeq data</strong> was also incorporated for T47D cells using Stripped media. A comparison between DHT treatment and Vehicle was performed. It should be noted that this dataset was generated using totalRNA and some technical issues appear to have reduced the statistical power of this dataset.</p>
<p><strong>H3K27Ac data</strong> from both E2 treatment and E2 + DHT was incorporated. Peaks were divided into promoters, based on overlap with any TSS from an expressed gene in the RNA-Seq data, and enhancers. Enhancers were considered to be those peaks which didn’t overlap any TSS, and super-enhancers were detected using the ROSE algorithm without modification.</p>
</div>
<div id="analytic-approaches" class="section level2">
<h2>Analytic Approaches</h2>
<pre class="r"><code>minWidth &lt;- 150</code></pre>
<p>All analyses of ChIP-Seq data was performed using consensus peaks for each transcription factor or histone mark. To form consensus peaks, all peaks were combined across treatments and overlapping peaks were merged into a single peak, encompassing the combined range. In addition, any putative peaks $$150bp were excluded as low quality peaks.</p>
</div>
</div>
<div id="data-import" class="section level1">
<h1>Data Import</h1>
<div id="gene-level-data" class="section level2">
<h2>Gene-Level Data</h2>
<pre class="r"><code>rnaseq &lt;- here::here(&quot;data/external/RNASeq/t47d_DHT_StrippedSerum_RNASeq_topTable.tsv&quot;) %&gt;%
  read_tsv()</code></pre>
<pre class="r"><code>geneModels &lt;- here::here(&quot;output/geneModels.rds&quot;) %&gt;%
  read_rds()
geneRanges &lt;- geneModels %&gt;% 
  split(f = .$gene) %&gt;% 
  range() %&gt;% 
  unlist() %&gt;%
  sort()
geneRanges$gene &lt;- names(geneRanges)
geneRanges$symbol &lt;- geneModels$symbol[match(geneRanges$gene, geneModels$gene)]
sq &lt;- seqinfo(geneModels)
transModels &lt;- here::here(&quot;output/transModels.rds&quot;) %&gt;%
  read_rds()</code></pre>
<p>Genes were parsed as condensed models just containing all relevant exons, and the ranges defined by the start/end points of each gene were also defined for easy comparison.</p>
<p>The RNA-Seq results from Stripped Serum were also loaded. This dataset comes with some caveats, in that very few genes were detected as DE in response to DHT treatment. This was likely to be an artefact of poor rRNA removal and the biases this leaves within a dataset. In total this dataset contained 13,013 detectable genes, broken into 55 up-regulated genes, 10 down-regulated genes, with the remaining 12,948 genes considered detectable, but not differentially expressed.</p>
<p>Whilst the comparison of AR and GATA3 ChIP peaks with differential expression may yield some insights, the clarification of the potential consequences for each peak should still be able to be extrapolated from the HiC and H3K27Ac data.</p>
</div>
<div id="chip-seq-data" class="section level2">
<h2>ChIP-Seq Data</h2>
<pre class="r"><code>allPeaks &lt;- chipBed %&gt;%
    sapply(function(x){
    import.bed(x) %&gt;%
      subset(seqnames %in% seqlevels(sq)) %&gt;%
      sortSeqlevels() %&gt;%
      keepSeqlevels(value = seqlevels(sq)) %&gt;%
      `seqinfo&lt;-`(value = sq) %&gt;%
      sort
  }, simplify = FALSE) %&gt;%
  setNames(basename(names(.))) %&gt;%
  setNames(str_remove_all(names(.), &quot;^.+T47D.&quot;)) %&gt;%
  setNames(str_extract_all(names(.), &quot;^[A-Za-z0-9_\\-]+&quot;)) %&gt;%
  setNames(str_remove_all(names(.), &quot;_peaks.*&quot;))</code></pre>
<pre class="r"><code>allWidths &lt;- names(allPeaks) %&gt;%
  lapply(
    function(x){
      tibble(width = width(allPeaks[[x]]), sample = x)
    }
  ) %&gt;%
  bind_rows() %&gt;%
  mutate(
    target = str_extract(sample, &quot;AR|GATA3|H3K27Ac&quot;),
    treatment = case_when(
      str_detect(sample, &quot;E2_DHT&quot;) ~ &quot;E2+DHT&quot;,
      str_detect(sample, &quot;E2&quot;) ~ &quot;E2&quot;,
    )
  ) %&gt;%
  arrange(sample, width) %&gt;%
  group_by(sample, target, treatment) %&gt;%
  mutate(n = seq_along(width) / length(width)) </code></pre>
<p>All previously identified ChIP-Seq peaks were assessed for width, given that peaks of 1bp were noticed in all samples. Peaks which are too short are unlikely to be true peaks and were removed, In addition, it was noticed that:</p>
<ul>
<li>H3K27Ac peaks were much broader than either GATA3 or AR peaks</li>
<li>AR peaks in the presence of DHT appeared to be broader. This may be a technical artefact. In general peak widths are dependent on fragment size defined prior to sequencing, and it is likely that the fragments in these samples were slightly longer than in the E2 alone samples.</li>
<li>GATA3 peak widths bore a close resemblance to each other and to Ar peak widths in E2 alone.</li>
</ul>
<pre class="r"><code>allWidths %&gt;%
  ggplot(aes(width, n, colour = sample)) +
  geom_line() +
  geom_vline(xintercept = minWidth, linetype = 2) +
  scale_x_log10(breaks = 10^seq(1, 5), labels = comma, expand = expansion(0, 0)) +
  scale_y_continuous(breaks = seq(0, 1, by = 0.2), labels = percent, expand = expansion(c(0.02, 0.02))) +
  scale_colour_brewer(palette = &quot;Paired&quot;) +
  labs(
    x = &quot;Peak Width&quot;,
    y = &quot;Cumulative Fraction&quot;,
    colour = &quot;Sample&quot;
  ) +
  theme(
    legend.position = c(0.01, 0.99),
    legend.justification = c(0, 1)
  )</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotWidths-1.png" alt="*Assessment of peak width for each set of consensus peaks. H3K27Ac peaks were noticeably wider than GATA3 or AR peaks, with AR peaks also appearing wider in the presence of DHT. The suggested peak size of 150bp is shown as a vertical line.*" width="960" />
<p class="caption">
<em>Assessment of peak width for each set of consensus peaks. H3K27Ac peaks were noticeably wider than GATA3 or AR peaks, with AR peaks also appearing wider in the presence of DHT. The suggested peak size of 150bp is shown as a vertical line.</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotWidths-1">
Past versions of plotWidths-1.png
</button>
</p>
<div id="fig-plotWidths-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotWidths-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>allWidths %&gt;% 
  summarise(
    Retained = sum(width &gt; minWidth),
    Lost = sum(width &lt;= minWidth),
    `% Lost` = mean(width &lt;= minWidth)
    ) %&gt;%
  mutate(`% Lost` = percent(`% Lost`, accuracy = 0.1)) %&gt;%
  rename_all(str_to_title) %&gt;%
  pander(
    justify = &quot;lllrrr&quot;,
    caption = glue(
      &quot;Summary of ChIP-Seq peaks for each target after restricting to a minimum peak size &gt;{minWidth}bp.&quot;
    )
  )</code></pre>
<table style="width:93%;">
<caption>Summary of ChIP-Seq peaks for each target after restricting to a minimum peak size &gt;150bp.</caption>
<colgroup>
<col width="23%" />
<col width="13%" />
<col width="16%" />
<col width="15%" />
<col width="11%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="left">Target</th>
<th align="left">Treatment</th>
<th align="right">Retained</th>
<th align="right">Lost</th>
<th align="right">% Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AR_E2</td>
<td align="left">AR</td>
<td align="left">E2</td>
<td align="right">3,338</td>
<td align="right">121</td>
<td align="right">3.5%</td>
</tr>
<tr class="even">
<td align="left">AR_E2_DHT</td>
<td align="left">AR</td>
<td align="left">E2+DHT</td>
<td align="right">23,598</td>
<td align="right">620</td>
<td align="right">2.6%</td>
</tr>
<tr class="odd">
<td align="left">GATA3-E2</td>
<td align="left">GATA3</td>
<td align="left">E2</td>
<td align="right">77,998</td>
<td align="right">3,798</td>
<td align="right">4.6%</td>
</tr>
<tr class="even">
<td align="left">GATA3-E2_DHT</td>
<td align="left">GATA3</td>
<td align="left">E2+DHT</td>
<td align="right">75,833</td>
<td align="right">3,161</td>
<td align="right">4.0%</td>
</tr>
<tr class="odd">
<td align="left">H3K27Ac_E2</td>
<td align="left">H3K27Ac</td>
<td align="left">E2</td>
<td align="right">41,672</td>
<td align="right">2,372</td>
<td align="right">5.4%</td>
</tr>
<tr class="even">
<td align="left">H3K27Ac_E2_DHT</td>
<td align="left">H3K27Ac</td>
<td align="left">E2+DHT</td>
<td align="right">43,806</td>
<td align="right">1,848</td>
<td align="right">4.0%</td>
</tr>
</tbody>
</table>
<pre class="r"><code>allPeaks &lt;- lapply(allPeaks, subset, width &gt; minWidth)</code></pre>
<p>In addition to the peaks, connections to the bigwig files were also setup for the purposes of visualisation.</p>
<pre class="r"><code>bw &lt;- here::here(&quot;data/external&quot;) %&gt;%
  list.files(pattern = &quot;bigwig&quot;, full.names = TRUE, recursive = TRUE) %&gt;%
  str_subset(&quot;_[1-3].bigwig&quot;, TRUE) %&gt;%
  str_subset(&quot;Pooled&quot;, TRUE) %&gt;%
  str_subset(&quot;H3K.+merged&quot;, TRUE) %&gt;%
  BigWigFileList() 
names(bw) &lt;- path(bw) %&gt;%
  basename() %&gt;%
  str_remove_all(&quot;[\\[\\]]&quot;) %&gt;%
  str_replace_all(&quot;[-\\+]&quot;, &quot;_&quot;) %&gt;%
  str_replace_all(&quot;.*T47D_(GATA3|AR|H3K27Ac)_(.+)(_merged.bigwig|.bigwig)&quot;, &quot;\\1_\\2&quot;) %&gt;%
  str_remove_all(&quot;_merged&quot;)</code></pre>
</div>
<div id="hic-interactions" class="section level2">
<h2>HiC Interactions</h2>
<p>Given that the different resolutions enabled by the different bin sizes will yield differing powers to detect interactions, significant (i.e. above background) interactions were loaded at 3 different resolutions: 10kb, 20kb and 40kb.</p>
<pre class="r"><code>gi40 &lt;- here::here(&quot;output/gi_40000.rds&quot;) %&gt;% read_rds()
gi20 &lt;- here::here(&quot;output/gi_20000.rds&quot;) %&gt;% read_rds()
gi10 &lt;- here::here(&quot;output/gi_10000.rds&quot;) %&gt;% read_rds()
gi &lt;- c(gi10, gi20, gi40) %&gt;%
  sort()
gi$binSize &lt;- width(gi)$first</code></pre>
<pre class="r"><code>gi %&gt;%
  anchorOne() %&gt;%
  width() %&gt;% 
  table() %&gt;% 
  enframe(name = &quot;Bin Size&quot;, value = &quot;Number of Interactions&quot;) %&gt;% 
  mutate_all(as.numeric) %&gt;%
  pander(
    caption = &quot;Breakdown of cis interactions detected for each bin size in the Encode T47D HiC data.&quot;
  )</code></pre>
<table style="width:50%;">
<caption>Breakdown of cis interactions detected for each bin size in the Encode T47D HiC data.</caption>
<colgroup>
<col width="15%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Bin Size</th>
<th align="center">Number of Interactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">10,000</td>
<td align="center">2,942</td>
</tr>
<tr class="even">
<td align="center">20,000</td>
<td align="center">8,469</td>
</tr>
<tr class="odd">
<td align="center">40,000</td>
<td align="center">18,811</td>
</tr>
</tbody>
</table>
</div>
<div id="h3k27ac-data" class="section level2">
<h2>H3K27Ac Data</h2>
<pre class="r"><code>promGR &lt;- here::here(&quot;output/promoters.bed&quot;) %&gt;% 
  import.bed() %&gt;%
  `seqinfo&lt;-`(value = sq) %&gt;%
  granges()
promGR$class &lt;- &quot;Promoter&quot;
enhGR &lt;- here::here(&quot;output/enhancers.bed&quot;) %&gt;% 
  import.bed() %&gt;%
  `seqinfo&lt;-`(value = sq) %&gt;%
  granges()
enhGR$class &lt;- &quot;Enhancer&quot;
seGR &lt;- here::here(&quot;output/SE.gtf&quot;) %&gt;%
  import.gff() %&gt;%
  `seqinfo&lt;-`(value = sq) %&gt;%
  granges()
seGR$class &lt;- &quot;Super Enhancer&quot;
h3k27ac &lt;- GRangesList(
  promGR,
  enhGR,
  seGR
) %&gt;%
  unlist() %&gt;%
  sort() %&gt;% 
  setNames(paste(seqnames(.), start(.), sep = &quot;_&quot;)) %&gt;% 
  names_to_column(&quot;peak_id&quot;) %&gt;%
  setNames(paste(.$class, .$peak_id, sep = &quot;_&quot;)) %&gt;% 
  names_to_column(&quot;feature_id&quot;)</code></pre>
<pre class="r"><code>h3k27ac$E2 &lt;- rep(FALSE, length(h3k27ac))
h3k27ac$E2[queryHits(findOverlaps(h3k27ac, allPeaks$H3K27Ac_E2))] &lt;- TRUE
h3k27ac$E2_DHT &lt;- rep(FALSE, length(h3k27ac))
h3k27ac$E2_DHT[queryHits(findOverlaps(h3k27ac, allPeaks$H3K27Ac_E2_DHT))] &lt;- TRUE
h3k27ac$group &lt;- mcols(h3k27ac) %&gt;%
  with(
    case_when(
      E2 &amp; E2_DHT ~ &quot;Common&quot;,
      !E2_DHT &amp; E2 ~ &quot;E2 Only&quot;,
      E2_DHT &amp; !E2 ~ &quot;E2+DHT Only&quot;,
      !E2_DHT &amp; !E2 ~ &quot;None&quot;
    )
  )
h3k27ac &lt;- subset(h3k27ac, group != &quot;None&quot;)</code></pre>
<p>It should also be noted that in the previous steps, promoters were restricted to H3K27Ac peaks which overlapped the TSS of genes detected as expressed in the RNA-Seq dataset. Any peaks which overlapped the TSS/Promoter of an undetectable gene were classed as Enhancers.</p>
<pre class="r"><code>h3k27ac %&gt;%
  with(
    tibble(
      width = width,
      class = class
    )
  ) %&gt;%
  mutate(
    class = factor(class, levels = c(&quot;Promoter&quot;, &quot;Enhancer&quot;, &quot;Super Enhancer&quot;))
  ) %&gt;%
  group_by(class) %&gt;%
  summarise(
    Total = dplyr::n(),
    `Total (bp)` = sum(width),
    `Median Width` = median(width),
    Shortest = min(width),
    Longest = max(width)
  ) %&gt;%
  rename_all(str_to_title) %&gt;%
  pander(
    caption = &quot;Description of all features defined by the H3K27Ac dataset. Any Enhancers contained within Super Ehancers were retained in both features&quot;
  )</code></pre>
<table>
<caption>Description of all features defined by the H3K27Ac dataset. Any Enhancers contained within Super Ehancers were retained in both features</caption>
<colgroup>
<col width="22%" />
<col width="11%" />
<col width="17%" />
<col width="19%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Class</th>
<th align="center">Total</th>
<th align="center">Total (Bp)</th>
<th align="center">Median Width</th>
<th align="center">Shortest</th>
<th align="center">Longest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Promoter</td>
<td align="center">14,117</td>
<td align="center">40,886,724</td>
<td align="center">2,283</td>
<td align="center">152</td>
<td align="center">74,203</td>
</tr>
<tr class="even">
<td align="center">Enhancer</td>
<td align="center">30,464</td>
<td align="center">41,464,184</td>
<td align="center">808</td>
<td align="center">151</td>
<td align="center">52,387</td>
</tr>
<tr class="odd">
<td align="center">Super Enhancer</td>
<td align="center">1,025</td>
<td align="center">6,305,057</td>
<td align="center">3,168</td>
<td align="center">1,054</td>
<td align="center">131,297</td>
</tr>
</tbody>
</table>
<p>Information regarding which dataset contained an overlap with each consensus peak was then added to each H3K27Ac site.</p>
<pre class="r"><code>h3k27ac %&gt;%
  subset(E2_DHT | E2) %&gt;% # Some peaks may have been removed as &lt; minWidth, but pass after merging
  mcols() %&gt;%
  as.data.frame() %&gt;%
  group_by(class, E2_DHT, E2) %&gt;%
  tally() %&gt;%
  ungroup() %&gt;%
  pivot_wider(names_from = class, values_from = n, values_fill = 0) %&gt;%
  mutate(
    `Treatment Group` = case_when(
      E2 &amp; E2_DHT ~ &quot;Both&quot;,
      !E2 &amp; E2_DHT ~ &quot;DHT Only&quot;,
      E2 &amp; !E2_DHT ~ &quot;E2 Only&quot;
    )
    ) %&gt;%
  arrange(`Treatment Group`) %&gt;%
  dplyr::select(`Treatment Group`, Promoter, contains(&quot;Enhancer&quot;)) %&gt;%
  pander(
    caption = &quot;
    *Summary of consensus H3K27Ac features by treatment group, simply showing presence/absence, not accounting for changed binding intensity.
    Notably, all Super Enhancers contained peaks which overlapped them in each group, however this does __not__ ensure that all Super Enhancers were defined as Super Ehancers in both treatment groups.
    The ROSE workflow did detect a small number of SEs which were unique to DHT treatment.*
    &quot;
  )</code></pre>
<table style="width:79%;">
<caption><em>Summary of consensus H3K27Ac features by treatment group, simply showing presence/absence, not accounting for changed binding intensity. Notably, all Super Enhancers contained peaks which overlapped them in each group, however this does <strong>not</strong> ensure that all Super Enhancers were defined as Super Ehancers in both treatment groups. The ROSE workflow did detect a small number of SEs which were unique to DHT treatment.</em></caption>
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="15%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Treatment Group</th>
<th align="center">Promoter</th>
<th align="center">Enhancer</th>
<th align="center">Super Enhancer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Both</td>
<td align="center">13,294</td>
<td align="center">21,975</td>
<td align="center">1,025</td>
</tr>
<tr class="even">
<td align="center">DHT Only</td>
<td align="center">621</td>
<td align="center">5,960</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">E2 Only</td>
<td align="center">202</td>
<td align="center">2,529</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="all-chip-data" class="section level1">
<h1>All ChIP Data</h1>
<p>Both GATA3 and AR ChIP datasets were loaded and consensus peaks identified based on the total size of any overlapping regions. These were then annotated simply based on gain or loss in DHT treatment, noting that GATA3 data contains two conditions (<em>Vehicle</em> and <em>DHT</em>) whilst AR data contained the conditions <em>E2</em> and <em>E2+DHT</em>. BigWig files contain the more subtle information regarding coverage, whilst this classification can indicate copmlete loss or gain of binding.</p>
<div id="all-gata3-sites" class="section level2">
<h2>All GATA3 Sites</h2>
<pre class="r"><code>gata3ConsGR &lt;- allPeaks %&gt;% 
  .[str_detect(names(.), &quot;GATA3&quot;)] %&gt;%
  as(&quot;GRangesList&quot;) %&gt;%
  unlist() %&gt;%
  GenomicRanges::reduce() %&gt;%
  setNames(paste0(seqnames(.), &quot;_&quot;, start(.))) %&gt;%
  names_to_column(&quot;peak_id&quot;)
gata3ConsGR$E2 &lt;- seq_along(gata3ConsGR) %in% queryHits(
  findOverlaps(gata3ConsGR, allPeaks$`GATA3-E2`)
)
gata3ConsGR$E2_DHT &lt;- seq_along(gata3ConsGR) %in% queryHits(
  findOverlaps(gata3ConsGR, allPeaks$`GATA3-E2_DHT`)
)
gata3ConsGR$group &lt;- mcols(gata3ConsGR) %&gt;%
  with(
    case_when(
      E2 &amp; E2_DHT ~ &quot;Common&quot;,
      !E2 &amp; E2_DHT ~ &quot;E2+DHT Only&quot;,
      E2 &amp; !E2_DHT ~ &quot;E2 Only&quot;
    )
  )</code></pre>
<p>In order to characterise the behaviours of the defined groups, the consensus set of 89,309 GATA3 peaks was defined as those detected in either Vehicle or DHT. In keeping with all steps of this analysis, any peaks <span class="math inline">\(\leq 150\)</span>bp were excluded.</p>
<pre class="r"><code>gata3ConsGR$group %&gt;%
  table() %&gt;%
  enframe(name = &quot;Group&quot;, value = &quot;Peaks&quot;) %&gt;%
  mutate(Peaks = as.numeric(Peaks)) %&gt;%
  bind_rows(
    tibble(Group = &quot;Total&quot;, Peaks = sum(.$Peaks))
  ) %&gt;%
  pander(
    caption = glue(
      &quot;Summary of consensus GATA3 peaks, after exclusion of any peaks $\\leq${minWidth}bp.&quot;
    ),
    emphasize.strong.rows = which(str_detect(.$Group, &quot;Total&quot;))
  )</code></pre>
<table style="width:39%;">
<caption>Summary of consensus GATA3 peaks, after exclusion of any peaks $$150bp.</caption>
<colgroup>
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Group</th>
<th align="center">Peaks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Common</td>
<td align="center">63,752</td>
</tr>
<tr class="even">
<td align="center">E2 Only</td>
<td align="center">13,970</td>
</tr>
<tr class="odd">
<td align="center">E2+DHT Only</td>
<td align="center">11,587</td>
</tr>
<tr class="even">
<td align="center"><strong>Total</strong></td>
<td align="center"><strong>89,309</strong></td>
</tr>
</tbody>
</table>
<pre class="r"><code>gata3Cons2Feature &lt;- gata3ConsGR %&gt;% 
  join_overlap_inner(h3k27ac) %&gt;% 
  mcols() %&gt;% 
  split(f = .$peak_id.x) %&gt;% 
  mclapply(function(x){unique(x$class)}, mc.cores = nc)</code></pre>
<p>Each consensus peak was then mapped to the features which overlapped the peak for downstream enrichment testing. A total of 19,956 peaks were mapped to 21,496 features, noting that many enhancers will overlap super enhancers.</p>
</div>
<div id="all-ar-sites" class="section level2">
<h2>All AR Sites</h2>
<pre class="r"><code>arConsGR &lt;- allPeaks %&gt;%
  .[str_detect(names(.), &quot;AR&quot;)] %&gt;%
  as(&quot;GRangesList&quot;) %&gt;%
  unlist() %&gt;%
  GenomicRanges::reduce() %&gt;%
  setNames(paste0(seqnames(.), &quot;_&quot;, start(.))) %&gt;%
  names_to_column(&quot;peak_id&quot;) 
arConsGR$E2 &lt;- seq_along(arConsGR) %in% queryHits(findOverlaps(arConsGR, allPeaks$AR_E2))
arConsGR$E2_DHT &lt;- seq_along(arConsGR) %in% queryHits(findOverlaps(arConsGR, allPeaks$AR_E2_DHT))
arConsGR$group &lt;- mcols(arConsGR) %&gt;%
  with(
    case_when(
      E2 &amp; E2_DHT ~ &quot;Common&quot;,
      !E2 &amp; E2_DHT ~ &quot;E2+DHT Only&quot;,
      E2 &amp; !E2_DHT ~ &quot;E2 Only&quot;,
      !E2 &amp; !E2_DHT ~ &quot;None&quot;
    )
  )</code></pre>
<p>In order to characterise the behaviours of the defined groups, the consensus set of 26,936 AR peaks was defined as those detected in either Vehicle or DHT, again relying on bigwig files for more subtle information regarding changes in coverage.</p>
<pre class="r"><code>arConsGR$group %&gt;%
  table() %&gt;%
  enframe(name = &quot;Group&quot;, value = &quot;Peaks&quot;) %&gt;%
  mutate(Peaks = as.numeric(Peaks)) %&gt;%
  bind_rows(
    tibble(Group = &quot;Total&quot;, Peaks = sum(.$Peaks))
  ) %&gt;%
  pander(
    caption = glue(
      &quot;Summary of consensus AR peaks, after exclusion of any peaks $\\leq${minWidth}bp.&quot;
    ),
    emphasize.strong.rows = which(str_detect(.$Group, &quot;Total&quot;))
  )</code></pre>
<table style="width:39%;">
<caption>Summary of consensus AR peaks, after exclusion of any peaks $$150bp.</caption>
<colgroup>
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Group</th>
<th align="center">Peaks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Common</td>
<td align="center">6,606</td>
</tr>
<tr class="even">
<td align="center">E2 Only</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">E2+DHT Only</td>
<td align="center">20,327</td>
</tr>
<tr class="even">
<td align="center"><strong>Total</strong></td>
<td align="center"><strong>26,936</strong></td>
</tr>
</tbody>
</table>
<pre class="r"><code>arCons2Feature &lt;- arConsGR %&gt;% 
  join_overlap_inner(h3k27ac) %&gt;% 
  mcols() %&gt;% 
  split(f = .$peak_id.x) %&gt;% 
  mclapply(function(x){unique(x$class)}, mc.cores = nc)</code></pre>
<p>Each consensus peak was then mapped to the features which overlapped the peak. A total of 13,312 peaks were mapped to 14,720 features, noting that many enhancers will overlap super enhancers.</p>
</div>
</div>
<div id="chip-peaks-by-ar-gata3-behavioural-groups" class="section level1">
<h1>ChIP Peaks By AR &amp; GATA3 Behavioural Groups</h1>
<div id="plotting-setup" class="section level2">
<h2>Plotting Setup</h2>
<pre class="r"><code>gen &lt;- &quot;hg19&quot;
ax &lt;- GenomeAxisTrack()
plotRegion &lt;- function(gr, zoom = 1, hic = gi, h3k27 = h3k27ac, gata3 = gata3ConsGR, ar = arConsGR, bigwig = bw, gm = geneModels, .ax = ax, rna = rnaseq, shift = 0, fs = 10, highlight = TRUE){
  
  stopifnot(is(gr, &quot;GRanges&quot;) | length(gr) &gt; 0)
  
  ## Form the Ideogram track
  chr &lt;- unique(as.character(seqnames(gr)))
  ideo &lt;- IdeogramTrack(genome = gen, chromosome = chr)
  
  ## The HiC Track
  goiInteractions &lt;- hic %&gt;%
    subsetByOverlaps(gr, ignore.strand = TRUE) %&gt;%
    # subset(distance &lt; width(gr)*zoom) %&gt;%
    # subset(distance &lt; maxIntDist) %&gt;%
    as(&quot;GenomicInteractions&quot;)
  hicTR &lt;- InteractionTrack(
    goiInteractions,
    chromosome = chr,
    name = &quot;HiC&quot;
  )
  displayPars(hicTR) &lt;- list(fontsize = fs, size = 1.2)
  
  ## Expand the range after looking for interactions within the initial range
  ## This keeps the range of interest in the centre
  origGR &lt;- gr
  gr &lt;- resize(gr, width = zoom*width(gr), fix = &quot;center&quot;)
  gr &lt;- shift(gr, shift)

  ## Setup the promoters, enhancers and super-enhancers as separate tracks
  promTR &lt;- h3k27 %&gt;%
    subsetByOverlaps(gr, ignore.strand = TRUE) %&gt;%
    subset(class %in% c(&quot;Promoter&quot;, &quot;Enhancer&quot;)) %&gt;%
    GeneRegionTrack(
      name = &quot;H3K27Ac&quot;,
      stacking = &quot;dense&quot;,
      col = &quot;transparent&quot;,
      feature = .$group,
      fontsize = fs,
      `Common` = &quot;grey&quot;,
      `E2+DHT Only` = &quot;red&quot;,
      `E2 Only` = &quot;blue&quot;,
      size = 0.8
    )
  if (length(promTR) == 0) promTR &lt;- c()
  h3CovGR &lt;- names(bigwig) %&gt;%
    str_subset(&quot;H3K27Ac&quot;) %&gt;%
    lapply(function(x){
      gr &lt;- import.bw(bigwig[[x]], which = gr)
      names(mcols(gr)) &lt;- str_remove(x, &quot;H3K27Ac_&quot;) 
      gr
    }) %&gt;%
    as(&quot;GRangesList&quot;) %&gt;%
    unlist()
  h3CovTR &lt;- h3CovGR %&gt;%
    DataTrack(
      groups = names(bigwig) %&gt;%
        str_subset(&quot;H3K27Ac&quot;) %&gt;%
        str_remove( &quot;H3K27Ac_&quot;),
      name = &quot;H3K27Ac&quot;, type = &quot;l&quot;, size = 1,
      legend = FALSE,
      col = c(&quot;blue&quot;, &quot;red&quot;),
      size = 2,
      fontsize = fs
  )
  seTR &lt;- h3k27 %&gt;%
    subsetByOverlaps(gr, ignore.strand = TRUE) %&gt;%
    subset(class == &quot;Super Enhancer&quot;) %&gt;%
    GeneRegionTrack(
      name = &quot;SE&quot;,
      stacking = &quot;dense&quot;,
      col = &quot;transparent&quot;,
      fill = &quot;#FFC34D&quot;,
      fontsize = fs,      
      size = 0.7
    )
  if (length(seTR) == 0) seTR &lt;- c()
  
  ## Setup the coverage track for GATA3
  gata3CovGR &lt;- names(bigwig) %&gt;%
    str_subset(&quot;GATA3&quot;) %&gt;%
    lapply(function(x){
      gr &lt;- import.bw(bigwig[[x]], which = gr)
      names(mcols(gr)) &lt;- str_remove(x, &quot;GATA3_&quot;) 
      gr
    }) %&gt;%
    as(&quot;GRangesList&quot;) %&gt;%
    unlist()
  gata3CovTR &lt;- gata3CovGR %&gt;%
    DataTrack(
      groups = names(bigwig) %&gt;%
        str_subset(&quot;GATA3&quot;) %&gt;%
        str_remove( &quot;GATA3_&quot;),
      name = &quot;GATA3&quot;, type = &quot;l&quot;, size = 1,
      legend = FALSE,
      col = c(&quot;blue&quot;, &quot;red&quot;),
      size = 2,
      fontsize = fs,
  )
  gata3TR &lt;-  gata3 %&gt;%
    subsetByOverlaps(gr, ignore.strand = TRUE) %&gt;%
      GeneRegionTrack(
      name = &quot;GATA3&quot;,
      stacking = &quot;dense&quot;,
      feature = .$group,
      size = 0.8,
      col = &quot;transparent&quot;,
      fontsize = fs,
      `Common` = &quot;grey&quot;,
      `E2+DHT Only` = &quot;red&quot;,
      `E2 Only` = &quot;blue&quot;
    )
  
  arTR &lt;- ar %&gt;%
    subsetByOverlaps(gr, ignore.strand = TRUE) %&gt;%
    GeneRegionTrack(
      name = &quot;AR&quot;,
      stacking = &quot;dense&quot;,
      feature = .$group,
      size = 0.8,
      col = &quot;transparent&quot;,
      fontsize = fs,      
      `Common` = &quot;grey&quot;,
      `E2+DHT Only` = &quot;red&quot;,
      `E2 Only` = &quot;blue&quot;
    )
  
  arCovGR &lt;- names(bigwig) %&gt;%
    str_subset(&quot;AR&quot;) %&gt;%
    lapply(function(x){
      gr &lt;- import.bw(bigwig[[x]], which = gr)
      names(mcols(gr)) &lt;- str_remove(x, &quot;AR&quot;) 
      gr
    }) %&gt;%
    as(&quot;GRangesList&quot;) %&gt;%
    unlist()
  arCovTR &lt;- arCovGR %&gt;%
    DataTrack(
      groups = names(bigwig) %&gt;%
        str_subset(&quot;AR&quot;) %&gt;%
        str_remove( &quot;AR&quot;),
      name = &quot;AR&quot;, type = &quot;l&quot;, size = 1,
      legend = FALSE,
      col = c(&quot;blue&quot;, &quot;red&quot;),
      size = 2,
      fontsize = fs
  )
  
  olGenes &lt;- unique(subsetByOverlaps(gm, gr, ignore.strand = TRUE)$gene)
  expTR &lt;- gm %&gt;%
    subset(gene %in% olGenes) %&gt;%
    subset(gene %in% rna$gene_id) %&gt;%
    GeneRegionTrack(
      name = &quot;Expressed&quot;,
      transcriptAnnotation = &quot;symbol&quot;,
      fill = &quot;#008000&quot;,
      col = &quot;transparent&quot;,
      fontsize = fs
    )
  notExpGR &lt;- gm %&gt;%
    subset(gene %in% olGenes) %&gt;%
    subset(!gene %in% rna$gene_id)
  notExpTR &lt;- c()
  if (length(notExpGR) &gt; 0){
    notExpTR &lt;- GeneRegionTrack(
      notExpGR,
      name = &quot;Not Expressed&quot;,
      transcriptAnnotation = &quot;symbol&quot;,
      fill = rgb(0.5, 0.5, 0.5, 0.5),
      size = 0.8,
      fontsize = fs,  
      collapseTranscripts = &quot;meta&quot;
    )
  }
  
  ## A rectangle highlight around the original range
  highTR &lt;- c(gata3TR, gata3CovTR, arTR, arCovTR, promTR, h3CovTR, expTR)
  if (highlight) {
    highTR &lt;- HighlightTrack(
      trackList = highTR,
      range = resize(origGR, width = max(1e-2*zoom*width(origGR), width(origGR)), fix = &quot;center&quot;),
      # col = rgb(0.9, 0.7, 0),
      col = &quot;black&quot;,
      fill = &quot;#FFFFFF00&quot;,
      inBackground = FALSE
    )  
  }
  
  # Now form the plot
  c(
    ideo, .ax, hicTR, seTR
  ) %&gt;%
    c(highTR) %&gt;%
    c(notExpTR) %&gt;%
    plotTracks(
      from = start(gr),
      to = end(gr)
    )
}</code></pre>
<p>As much of the group-level analysis will involve plotting, a simple wrapper function was written to enable simple plotting of all tracks.</p>
</div>
<div id="gata3-sites-gained-with-dht" class="section level2">
<h2>GATA3 Sites Gained With DHT</h2>
<pre class="r"><code>chipGR &lt;- here::here(&quot;data/external/BED/AR_GATA3_Groups/Galaxy280-[T47D-GATA3-DHT-ONLY].bed&quot;) %&gt;%
  import.bed() %&gt;%
  subset(seqnames %in% seqlevels(sq)) %&gt;%
  sortSeqlevels() %&gt;%
  keepSeqlevels(value = seqlevels(sq)) %&gt;%
  sort() %&gt;%
  subset(width &gt; minWidth) %&gt;%
  c(
    subsetByOverlaps(gata3ConsGR, .)
  ) %&gt;%
  GenomicRanges::reduce() %&gt;%
  setNames(paste0(seqnames(.), &quot;_&quot;, start(.))) %&gt;%
  names_to_column(&quot;peak_id&quot;) %&gt;%
  `seqinfo&lt;-`(value = sq)</code></pre>
<p>The first group of sites to integrate were the GATA3 ChIP peaks gained under DHT treatment, but where no corresponding increase was seen in the AR ChIP peaks. Data was imported for a total of 63,287 peaks, excluding peaks <span class="math inline">\(\leq\)</span> 150bp. This peaks were merged with the consensus GATA3 peaks defined previously to ensure direct comparability between groups. This set of peaks captured 71% of consensus GATA3 peaks.</p>
<pre class="r"><code>ol &lt;- findOverlaps(chipGR, h3k27ac)</code></pre>
<p>The first step is to subset and merge these sites with those which overlap a defined promoter or enhancer. This step reduced the set of peaks to 63,287 unique peaks, however, given that some peaks may partially overlap multiple H3K27Ac-defined regions, this represented a total of 63,287 mappings between the two datasets.</p>
<pre class="r"><code>chipGR %&gt;%
  join_overlap_inner(h3k27ac) %&gt;%
  with(
    tibble(
      width = width,
      class = class,
      feature_id = feature_id
    )
  ) %&gt;%
  group_by(class) %&gt;%
  summarise(
    `Total Mapped Peaks` = dplyr::n(),
    `Total (bp)` = sum(width),
    `Median Width` = median(width),
    Shortest = min(width),
    Longest = max(width)
  ) %&gt;%
  rename_all(str_to_title) %&gt;%
  pander(
    caption = glue(
      &quot;Summary of mappings from ChIP peaks (DHT-gained GATA3 peaks) to regions defined by the H3K27Ac dataset.&quot;,
      &quot;Of the original {comma(length(chipGR))} peaks in this group, only {comma(sum(.$`Total Mapped Peaks`))} were mapped to a regulatory feature.&quot;
    )
  )</code></pre>
<table>
<caption>Summary of mappings from ChIP peaks (DHT-gained GATA3 peaks) to regions defined by the H3K27Ac dataset.Of the original 63,287 peaks in this group, only 10,975 were mapped to a regulatory feature.</caption>
<colgroup>
<col width="19%" />
<col width="23%" />
<col width="14%" />
<col width="17%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Class</th>
<th align="center">Total Mapped Peaks</th>
<th align="center">Total (Bp)</th>
<th align="center">Median Width</th>
<th align="center">Shortest</th>
<th align="center">Longest</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Enhancer</td>
<td align="center">6,085</td>
<td align="center">2,738,184</td>
<td align="center">391</td>
<td align="center">153</td>
<td align="center">2,219</td>
</tr>
<tr class="even">
<td align="center">Promoter</td>
<td align="center">4,274</td>
<td align="center">1,873,228</td>
<td align="center">390</td>
<td align="center">152</td>
<td align="center">2,953</td>
</tr>
<tr class="odd">
<td align="center">Super Enhancer</td>
<td align="center">616</td>
<td align="center">274,467</td>
<td align="center">376</td>
<td align="center">153</td>
<td align="center">2,219</td>
</tr>
</tbody>
</table>
<div id="enrichment-testing" class="section level3">
<h3>Enrichment Testing</h3>
<p>The first step is to ascertain whether the peaks where GATA3 binding is increased under DHT treatment, are associated with any specific feature from the H3K27Ac dataset, such as Promoters, Enhancers of Super Enhancers. The size of the peak may bias any mapping and this was used as a sampling offset using the Wallenius approximation for biased sampling in the hypergeometric distribution.</p>
<p>For enrichment testing, each feature was considered as analogous to a gene, with a peak being mapped to it being considered as ‘success’. All 3 feature types were assessed by considering that feature type, and grouping the other feature types. In this manner, only the peaks which overlapped a defined feature were considered for enrichment testing.</p>
<pre class="r"><code>mapped &lt;- seq_along(gata3ConsGR) %in% queryHits(findOverlaps(gata3ConsGR, chipGR)) %&gt;%
  setNames(gata3ConsGR$peak_id)
pwf &lt;- nullp(mapped, bias.data = width(gata3ConsGR), plot.fit = FALSE)
enrichRes &lt;- goseq(pwf, gene2cat = gata3Cons2Feature)
enrichRes %&gt;%
  mutate(
    Percentage = percent(numDEInCat / numInCat),
    over_represented_pvalue = sprintf(&quot;%.3e&quot;, p.adjust(over_represented_pvalue, &quot;bonf&quot;))
  ) %&gt;%
  dplyr::select(
    Feature = category,
    adjP = over_represented_pvalue,
    `Number Mapped in Group Peaks` = numDEInCat,
    `Consensus Peaks Mapped` = numInCat,
    `Percentage Mapped` = Percentage
  ) %&gt;%
  pander(
    caption = &quot;Assessment of enrichment for mappings of DHT-responsive GATA3 peaks to genomic features defined by H3K27Ac data. **These numbers need to be checked against those above!!!**&quot;
  )</code></pre>
<table>
<caption>Assessment of enrichment for mappings of DHT-responsive GATA3 peaks to genomic features defined by H3K27Ac data. <strong>These numbers need to be checked against those above!!!</strong></caption>
<colgroup>
<col width="16%" />
<col width="12%" />
<col width="29%" />
<col width="23%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Feature</th>
<th align="center">adjP</th>
<th align="center">Number Mapped in Group Peaks</th>
<th align="center">Consensus Peaks Mapped</th>
<th align="center">Percentage Mapped</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Promoter</td>
<td align="center">9.018e-160</td>
<td align="center">4,047</td>
<td align="center">6,617</td>
<td align="center">61.2%</td>
</tr>
<tr class="even">
<td align="center">Enhancer</td>
<td align="center">1.000e+00</td>
<td align="center">5,578</td>
<td align="center">13,334</td>
<td align="center">41.8%</td>
</tr>
<tr class="odd">
<td align="center">Super Enhancer</td>
<td align="center">1.000e+00</td>
<td align="center">578</td>
<td align="center">1,545</td>
<td align="center">37.4%</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="comparison-between-promoters-and-gene-expression" class="section level2">
<h2>Comparison between Promoters and Gene Expression</h2>
<div id="differentially-expressed-genes" class="section level3 tabset">
<h3>Differentially Expressed Genes</h3>
<p>Of the 13,013 genes which were detectable in the corresponding RNA-Seq analysis, peaks corresponding to a gain of GATA3 under DHT treatment were found in the promoters of 2851 genes.</p>
<pre class="r"><code>chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  mcols() %&gt;%
  as.data.frame() %&gt;%
  as_tibble() %&gt;%
  dplyr::rename(`H3K27Ac Group` = group) %&gt;%
  dplyr::select(-peak_id.y) %&gt;%
  chop(c(peak_id.x, feature_id)) %&gt;%
  inner_join(rnaseq, by = c(&quot;gene&quot; = &quot;gene_id&quot;, &quot;symbol&quot; = &quot;gene_name&quot;)) %&gt;%
  arrange(PValue) %&gt;%
  dplyr::filter(DE) %&gt;%
  dplyr::mutate(
    `Peaks In Promoter` = vapply(peak_id.x, length, integer(1)),
    PValue = sprintf(&quot;%.2e&quot;, PValue),
    FDR = case_when(
      FDR &gt; 0.001 ~ sprintf(&quot;%.3f&quot;, FDR),
      FDR &lt;= 0.001 ~ sprintf(&quot;%.3e&quot;, FDR)
    )
  ) %&gt;%
  dplyr::select(ID = gene, Name = symbol, `Peaks In Promoter`, `H3K27Ac Group`,  logFC, logCPM, PValue, FDR) %&gt;%
  pander(
    justify = &quot;llrlrrrr&quot;,
    caption = &quot;
    RNA-Seq results for DHT-responsive GATA3 peaks which map to promoters. 
    Only Differentially expressed genes are shown, to an FDR of 5%. 
    All but one of these genes was up-regulated, however, given that most DE genes were up-regulated this was not statistically significant.
    &quot;,
    emphasize.strong.rows = which(str_detect(.$`H3K27Ac Group`, &quot;DHT&quot;))
  )</code></pre>
<table>
<caption>RNA-Seq results for DHT-responsive GATA3 peaks which map to promoters. Only Differentially expressed genes are shown, to an FDR of 5%. All but one of these genes was up-regulated, however, given that most DE genes were up-regulated this was not statistically significant.</caption>
<colgroup>
<col width="17%" />
<col width="10%" />
<col width="15%" />
<col width="14%" />
<col width="9%" />
<col width="9%" />
<col width="11%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="left">Name</th>
<th align="right">Peaks In Promoter</th>
<th align="left">H3K27Ac Group</th>
<th align="right">logFC</th>
<th align="right">logCPM</th>
<th align="right">PValue</th>
<th align="right">FDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSG00000164188</td>
<td align="left">RANBP3L</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">2.343</td>
<td align="right">5.477</td>
<td align="right">1.82e-11</td>
<td align="right">7.320e-08</td>
</tr>
<tr class="even">
<td align="left">ENSG00000135373</td>
<td align="left">EHF</td>
<td align="right">4</td>
<td align="left">Common</td>
<td align="right">1.075</td>
<td align="right">7.95</td>
<td align="right">2.25e-11</td>
<td align="right">7.320e-08</td>
</tr>
<tr class="odd">
<td align="left"><strong>ENSG00000109906</strong></td>
<td align="left"><strong>ZBTB16</strong></td>
<td align="right"><strong>1</strong></td>
<td align="left"><strong>E2+DHT Only</strong></td>
<td align="right"><strong>5.609</strong></td>
<td align="right"><strong>2.315</strong></td>
<td align="right"><strong>8.05e-10</strong></td>
<td align="right"><strong>1.494e-06</strong></td>
</tr>
<tr class="even">
<td align="left">ENSG00000152661</td>
<td align="left">GJA1</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">1.941</td>
<td align="right">2.698</td>
<td align="right">9.18e-10</td>
<td align="right">1.494e-06</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000127663</td>
<td align="left">KDM4B</td>
<td align="right">2</td>
<td align="left">Common</td>
<td align="right">1.165</td>
<td align="right">5.407</td>
<td align="right">4.53e-09</td>
<td align="right">5.892e-06</td>
</tr>
<tr class="even">
<td align="left">ENSG00000111961</td>
<td align="left">SASH1</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">1.006</td>
<td align="right">4.939</td>
<td align="right">2.18e-08</td>
<td align="right">2.360e-05</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000181744</td>
<td align="left">DIPK2A</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">0.8745</td>
<td align="right">6.018</td>
<td align="right">2.76e-08</td>
<td align="right">2.763e-05</td>
</tr>
<tr class="even">
<td align="left">ENSG00000167291</td>
<td align="left">TBC1D16</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">0.7529</td>
<td align="right">5.751</td>
<td align="right">4.99e-08</td>
<td align="right">4.634e-05</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000196208</td>
<td align="left">GREB1</td>
<td align="right">5</td>
<td align="left">Common</td>
<td align="right">0.7876</td>
<td align="right">6.165</td>
<td align="right">6.58e-08</td>
<td align="right">5.039e-05</td>
</tr>
<tr class="even">
<td align="left">ENSG00000170017</td>
<td align="left">ALCAM</td>
<td align="right">3</td>
<td align="left">Common</td>
<td align="right">0.726</td>
<td align="right">7.451</td>
<td align="right">6.75e-08</td>
<td align="right">5.039e-05</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000096060</td>
<td align="left">FKBP5</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">0.981</td>
<td align="right">6.455</td>
<td align="right">6.97e-08</td>
<td align="right">5.039e-05</td>
</tr>
<tr class="even">
<td align="left">ENSG00000143153</td>
<td align="left">ATP1B1</td>
<td align="right">2</td>
<td align="left">Common</td>
<td align="right">0.6196</td>
<td align="right">6.459</td>
<td align="right">1.13e-06</td>
<td align="right">6.110e-04</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000064042</td>
<td align="left">LIMCH1</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">0.5892</td>
<td align="right">5.103</td>
<td align="right">4.80e-06</td>
<td align="right">0.002</td>
</tr>
<tr class="even">
<td align="left">ENSG00000137266</td>
<td align="left">SLC22A23</td>
<td align="right">3</td>
<td align="left">Common</td>
<td align="right">0.6319</td>
<td align="right">5.852</td>
<td align="right">1.34e-05</td>
<td align="right">0.005</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000159216</td>
<td align="left">RUNX1</td>
<td align="right">3</td>
<td align="left">Common</td>
<td align="right">0.6325</td>
<td align="right">4.192</td>
<td align="right">1.47e-05</td>
<td align="right">0.006</td>
</tr>
<tr class="even">
<td align="left">ENSG00000138696</td>
<td align="left">BMPR1B</td>
<td align="right">4</td>
<td align="left">Common</td>
<td align="right">-0.704</td>
<td align="right">3.476</td>
<td align="right">2.73e-05</td>
<td align="right">0.009</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000152766</td>
<td align="left">ANKRD22</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">0.5644</td>
<td align="right">5.298</td>
<td align="right">3.87e-05</td>
<td align="right">0.012</td>
</tr>
<tr class="even">
<td align="left">ENSG00000256229</td>
<td align="left">ZNF486</td>
<td align="right">1</td>
<td align="left">Common</td>
<td align="right">0.6752</td>
<td align="right">3.32</td>
<td align="right">7.83e-05</td>
<td align="right">0.021</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000149292</td>
<td align="left">TTC12</td>
<td align="right">2</td>
<td align="left">Common</td>
<td align="right">0.5598</td>
<td align="right">4.88</td>
<td align="right">8.64e-05</td>
<td align="right">0.022</td>
</tr>
<tr class="even">
<td align="left">ENSG00000049759</td>
<td align="left">NEDD4L</td>
<td align="right">2</td>
<td align="left">Common</td>
<td align="right">0.4862</td>
<td align="right">6.147</td>
<td align="right">9.13e-05</td>
<td align="right">0.022</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000047644</td>
<td align="left">WWC3</td>
<td align="right">2</td>
<td align="left">Common</td>
<td align="right">0.4455</td>
<td align="right">7.579</td>
<td align="right">1.56e-04</td>
<td align="right">0.035</td>
</tr>
</tbody>
</table>
<pre class="r"><code>rnaseq %&gt;%
  mutate(
    gata3PeakInProm = gene_id %in% (
      chipGR %&gt;%
        join_overlap_intersect(h3k27ac) %&gt;%
        subset(class == &quot;Promoter&quot;) %&gt;%
        join_overlap_intersect(geneRanges) %&gt;%
        mcols() %&gt;%
        as.data.frame() %&gt;% 
        pull(&quot;gene&quot;)
    ),
    DE = FDR &lt; 0.05
  ) %&gt;%
  group_by(DE, gata3PeakInProm) %&gt;%
  tally() %&gt;%
  pivot_wider(names_from = DE, values_from = n) %&gt;%
  with(
    cbind(`FALSE`, `TRUE`)
  ) %&gt;%
  fisher.test() %&gt;%
  pander(
    caption = &quot;Fisher&#39;s Exact Test providing weak support for enrichment of GATA3 gained peaks within the promoters of DE genes, using an FDR of 0.05 to consider a gene as DE&quot;
  )</code></pre>
<table style="width:67%;">
<caption>Fisher’s Exact Test providing weak support for enrichment of GATA3 gained peaks within the promoters of DE genes, using an FDR of 0.05 to consider a gene as DE</caption>
<colgroup>
<col width="13%" />
<col width="34%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
<th align="center">odds ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.05001</td>
<td align="center">two.sided</td>
<td align="center">1.706</td>
</tr>
</tbody>
</table>
<div id="zbtb16" class="section level4">
<h4><em>ZBTB16</em></h4>
<p>The gene ZBTB16 has a gain of GATA3 in it’s promoter under DHT treatment, as well as the gain of an H3K27Ac peak under DHT treatment. It is also one of the most significantly up regulated genes in response to DHT. Whilst an interaction between the ZBTB16 promoter and a downstream region was detected, this region did not interact with any other GATA peaks and appeared inconclusive.</p>
<p>However, it is clear that there are:</p>
<ul>
<li>Synchronous gains of both GATA3 and AR in the upstream enhancer, along with increased H3K27Ac enhancer marks for two of these three enhancers</li>
<li>Displaced gains of AR and GATA3 in the upstream promoter, but with no increase in H3K27Ac signal</li>
<li>Increased GATA3 without AR in the direct promoter, along with increased H3K27Ac signal in the promoter</li>
</ul>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;ZBTB16&quot;)
plotRegion(gr, zoom = 1000, gm = transModels, shift = 1e5)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotZBTB16-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotZBTB16-1">
Past versions of plotZBTB16-1.png
</button>
</p>
<div id="fig-plotZBTB16-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotZBTB16-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/eb8d7988a8f408b7307baefb859e1e0a1d6f1f82/docs/figure/chip_integration.Rmd/plotZBTB16-1.png" target="_blank">eb8d798</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/e120d5420b7952e0b78fa9f622d985b23d3b5857/docs/figure/chip_integration.Rmd/plotZBTB16-1.png" target="_blank">e120d54</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-25
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>plotRegion(gr, zoom = 150, gm = transModels, shift = -5e3, fs = 10)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotZBTB16_zoom-1.png" alt="*Zoomed in version of the above plot.*" width="960" />
<p class="caption">
<em>Zoomed in version of the above plot.</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotZBTB16_zoom-1">
Past versions of plotZBTB16_zoom-1.png
</button>
</p>
<div id="fig-plotZBTB16_zoom-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotZBTB16_zoom-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/eb8d7988a8f408b7307baefb859e1e0a1d6f1f82/docs/figure/chip_integration.Rmd/plotZBTB16_zoom-1.png" target="_blank">eb8d798</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ranbp3l" class="section level4">
<h4><em>RANBP3L</em></h4>
<p>The most highly ranked DE gene with an AR-independent GATA3 gain under DHT was <em>RANBP3L</em>. Given that we have GATA3 already in the promoter and AR is gained in the promoter, this may be a misclassification. Is it worth considering a coverage threshold to consider a gain? Is it worth performing a scan of nearby peaks to see if there are any AR gains at other peaks nearby?</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;RANBP3L&quot;)
plotRegion(gr, zoom = 240, gm = transModels, shift = -2.5e4)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotRANBP3L-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotRANBP3L-1">
Past versions of plotRANBP3L-1.png
</button>
</p>
<div id="fig-plotRANBP3L-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotRANBP3L-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/bb0397c044aee699ee18061cea70166232cfac3c/docs/figure/chip_integration.Rmd/plotRANBP3L-1.png" target="_blank">bb0397c</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/eb8d7988a8f408b7307baefb859e1e0a1d6f1f82/docs/figure/chip_integration.Rmd/plotRANBP3L-1.png" target="_blank">eb8d798</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="ehf" class="section level4">
<h4><em>EHF</em></h4>
<p>The second most highly ranked DE gene with an AR-independent GATA3 gain under DHT was <em>EHF</em>. There was a discrepancy with the peak assignment to group, with four peaks being considered as GATA3-gained in DHT only, but coverage was uncompelling. These may need to be rethought.</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;EHF&quot;)
plotRegion(gr[1], zoom = 20, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotEHF-1.png" alt="*Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.*" width="960" />
<p class="caption">
<em>Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotEHF-1">
Past versions of plotEHF-1.png
</button>
</p>
<div id="fig-plotEHF-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotEHF-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/eb8d7988a8f408b7307baefb859e1e0a1d6f1f82/docs/figure/chip_integration.Rmd/plotEHF-1.png" target="_blank">eb8d798</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>plotRegion(gr[2], zoom = 50, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotEHF-2.png" alt="*Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.*" width="960" />
<p class="caption">
<em>Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotEHF-2">
Past versions of plotEHF-2.png
</button>
</p>
<div id="fig-plotEHF-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotEHF-2.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>plotRegion(gr[3], zoom = 50, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotEHF-3.png" alt="*Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.*" width="960" />
<p class="caption">
<em>Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotEHF-3">
Past versions of plotEHF-3.png
</button>
</p>
<div id="fig-plotEHF-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotEHF-3.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>plotRegion(gr[4], zoom = 100, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotEHF-4.png" alt="*Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.*" width="960" />
<p class="caption">
<em>Zoomed view of EHF showing the 4 peaks assigned as AR-independent DHT-responsive. The first was clearly detected in GATA3_E2 as well as GATA3_ E2+DHT, whilst the second one was corectly annotated.</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotEHF-4">
Past versions of plotEHF-4.png
</button>
</p>
<div id="fig-plotEHF-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotEHF-4.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>However, the interactions detected connect this gene with <em>ELF5</em> and <em>APIP</em>, both of which were detected as expressed in the RNA-Seq data. <em>ELF5</em> appears to be actively expressed independently of AR &amp; GATA3, whilst <em>APIP</em> may be of interest.</p>
<pre class="r"><code>plotRegion(range(gr), zoom = 20, gm = transModels, shift = 7e4, fs = 10)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotEHFExpanded-1.png" alt="*Expanded view of the above showing HiC contact locations*" width="960" />
<p class="caption">
<em>Expanded view of the above showing HiC contact locations</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotEHFExpanded-1">
Past versions of plotEHFExpanded-1.png
</button>
</p>
<div id="fig-plotEHFExpanded-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotEHFExpanded-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/eb8d7988a8f408b7307baefb859e1e0a1d6f1f82/docs/figure/chip_integration.Rmd/plotEHFExpanded-1.png" target="_blank">eb8d798</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="gja1" class="section level4">
<h4><em>GJA1</em></h4>
<p>This peak again appears misclassified, as it wasn’t found in the GATA3 E2+DHT bed file. However, there appears to be be increased activity at the promoter. The HiC interaction connects to a region with no defined genes, promoters or enhancers.</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;GJA1&quot;)
plotRegion(gr, zoom = 20, gm = transModels, shift = 3e3)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotGJA1-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotGJA1-1">
Past versions of plotGJA1-1.png
</button>
</p>
<div id="fig-plotGJA1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotGJA1-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="kdm4b" class="section level4">
<h4><em>KDM4B</em></h4>
<p>These peaks again appear potentially misclassified. However, there appears to be be increased activity at the promoter. The HiC interaction connects to a region with no defined genes, promoters or enhancers.</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;KDM4B&quot;)
plotRegion(gr[1], zoom = 80, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotKDM4B-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotKDM4B-1">
Past versions of plotKDM4B-1.png
</button>
</p>
<div id="fig-plotKDM4B-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotKDM4B-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>plotRegion(gr[2], zoom = 200, gm = transModels, shift = 6e3)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotKDM4B-2.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotKDM4B-2">
Past versions of plotKDM4B-2.png
</button>
</p>
<div id="fig-plotKDM4B-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotKDM4B-2.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="sash1" class="section level4">
<h4><em>SASH1</em></h4>
<p>Another peak which is not very compelling</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;SASH1&quot;)
plotRegion(gr[1], zoom = 50, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotSASH1-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotSASH1-1">
Past versions of plotSASH1-1.png
</button>
</p>
<div id="fig-plotSASH1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotSASH1-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="dipk2a" class="section level4">
<h4><em>DIPK2A</em></h4>
<p>Another peak which is not very compelling</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;DIPK2A&quot;)
plotRegion(gr[1], zoom = 50, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotDIPK2A-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
</div>
<div id="tbc1d16" class="section level4">
<h4><em>TBC1D16</em></h4>
<p>Another peak which is not very compelling</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;TBC1D16&quot;)
plotRegion(gr[1], zoom = 50, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotTBC1D16-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<pre class="r"><code>plotRegion(gr[1], zoom = 400, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotTBC1D16-2.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
</div>
<div id="greb1" class="section level4">
<h4><em>GREB1</em></h4>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;GREB1&quot;)
plotRegion(range(gr), zoom = 2.5, shift = 4e4, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotGREB1-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plotGREB1-1">
Past versions of plotGREB1-1.png
</button>
</p>
<div id="fig-plotGREB1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/DRMCRL/ENCODE_T47D_HiC_ENCSR549MGQ/blob/4b4153fa2df83c0356518a5e048d9766ab7538a2/docs/figure/chip_integration.Rmd/plotGREB1-1.png" target="_blank">4b4153f</a>
</td>
<td>
Steve Ped
</td>
<td>
2020-11-26
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These 5 peaks again appear un compelling.</p>
<pre class="r"><code>plotRegion(gr[1], zoom = 100, gm = transModels, shift = 9e3)</code></pre>
<p><img src="figure/chip_integration.Rmd/plotGREB1_peaks-1.png" width="960" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plotRegion(gr[2], zoom = 200, gm = transModels)</code></pre>
<p><img src="figure/chip_integration.Rmd/plotGREB1_peaks-2.png" width="960" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plotRegion(gr[3], zoom = 100, gm = transModels)</code></pre>
<p><img src="figure/chip_integration.Rmd/plotGREB1_peaks-3.png" width="960" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plotRegion(gr[4], zoom = 100, gm = transModels)</code></pre>
<p><img src="figure/chip_integration.Rmd/plotGREB1_peaks-4.png" width="960" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plotRegion(gr[5], zoom = 50, gm = transModels)</code></pre>
<p><img src="figure/chip_integration.Rmd/plotGREB1_peaks-5.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="fkbp5" class="section level4">
<h4><em>FKBP5</em></h4>
<p>I’d almost buy this one apart from the really weak signal. Do we have one transcript responding to AR, whilst there is another responding to GATA3 without AR?</p>
<pre class="r"><code>gr &lt;- chipGR %&gt;%
  join_overlap_intersect(h3k27ac) %&gt;%
  subset(class == &quot;Promoter&quot;) %&gt;%
  join_overlap_intersect(geneRanges) %&gt;%
  subset(symbol == &quot;FKBP5&quot;)
plotRegion(gr[1], zoom = 80, gm = transModels)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotFKBP5-1.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<pre class="r"><code>plotRegion(gr[1], zoom = 700, gm = transModels, shift = -4e4)</code></pre>
<div class="figure" style="text-align: center">
<img src="figure/chip_integration.Rmd/plotFKBP5-2.png" alt="*Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site*" width="960" />
<p class="caption">
<em>Overlay of HiC Interactions, GATA3 binding sites and H3K27Ac marks. For GATA3 peaks, Promoters, Enhancers and Super Enhancers, red indicates a gain under DHT, grey represents common sites across treatments and blue indicates a loss under DHT. Expressed genes are displayed in green with all transcripts showing. Undetectable genes from the RNA Seq dataset are condensed into a single representative transcript in the bottom panel. The rectangular box highlights the relevant GATA3 site</em>
</p>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
 [1] grid      parallel  stats4    stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] goseq_1.42.0                geneLenDataBase_1.26.0     
 [3] BiasedUrn_1.07              plyranges_1.10.0           
 [5] magrittr_1.5                GenomicInteractions_1.24.0 
 [7] InteractionSet_1.18.0       SummarizedExperiment_1.20.0
 [9] Biobase_2.50.0              MatrixGenerics_1.2.0       
[11] matrixStats_0.57.0          scales_1.1.1               
[13] pander_0.6.3                Rsamtools_2.6.0            
[15] Biostrings_2.58.0           XVector_0.30.0             
[17] glue_1.4.2                  Gviz_1.34.0                
[19] forcats_0.5.0               stringr_1.4.0              
[21] dplyr_1.0.2                 purrr_0.3.4                
[23] readr_1.4.0                 tidyr_1.1.2                
[25] tibble_3.0.4                ggplot2_3.3.2              
[27] tidyverse_1.3.0             rtracklayer_1.50.0         
[29] GenomicRanges_1.42.0        GenomeInfoDb_1.26.0        
[31] IRanges_2.24.0              S4Vectors_0.28.0           
[33] BiocGenerics_0.36.0         workflowr_1.6.2            

loaded via a namespace (and not attached):
  [1] readxl_1.3.1             backports_1.2.0          Hmisc_4.4-1             
  [4] BiocFileCache_1.14.0     igraph_1.2.6             lazyeval_0.2.2          
  [7] splines_4.0.3            BiocParallel_1.24.0      digest_0.6.27           
 [10] ensembldb_2.14.0         htmltools_0.5.0          GO.db_3.12.1            
 [13] fansi_0.4.1              checkmate_2.0.0          memoise_1.1.0           
 [16] BSgenome_1.58.0          cluster_2.1.0            modelr_0.1.8            
 [19] askpass_1.1              prettyunits_1.1.1        jpeg_0.1-8.1            
 [22] colorspace_1.4-1         blob_1.2.1               rvest_0.3.6             
 [25] rappdirs_0.3.1           haven_2.3.1              xfun_0.19               
 [28] crayon_1.3.4             RCurl_1.98-1.2           jsonlite_1.7.1          
 [31] survival_3.2-7           VariantAnnotation_1.36.0 gtable_0.3.0            
 [34] zlibbioc_1.36.0          DelayedArray_0.16.0      DBI_1.1.0               
 [37] Rcpp_1.0.5               progress_1.2.2           htmlTable_2.1.0         
 [40] foreign_0.8-79           bit_4.0.4                Formula_1.2-4           
 [43] htmlwidgets_1.5.2        httr_1.4.2               RColorBrewer_1.1-2      
 [46] ellipsis_0.3.1           farver_2.0.3             pkgconfig_2.0.3         
 [49] XML_3.99-0.5             nnet_7.3-14              dbplyr_2.0.0            
 [52] here_0.1                 tidyselect_1.1.0         rlang_0.4.8             
 [55] later_1.1.0.1            AnnotationDbi_1.52.0     munsell_0.5.0           
 [58] cellranger_1.1.0         tools_4.0.3              cli_2.1.0               
 [61] generics_0.1.0           RSQLite_2.2.1            broom_0.7.2             
 [64] evaluate_0.14            yaml_2.2.1               knitr_1.30              
 [67] bit64_4.0.5              fs_1.5.0                 AnnotationFilter_1.14.0 
 [70] nlme_3.1-149             whisker_0.4              xml2_1.3.2              
 [73] biomaRt_2.46.0           compiler_4.0.3           rstudioapi_0.11         
 [76] curl_4.3                 png_0.1-7                reprex_0.3.0            
 [79] stringi_1.5.3            highr_0.8                GenomicFeatures_1.42.0  
 [82] lattice_0.20-41          ProtGenerics_1.22.0      Matrix_1.2-18           
 [85] vctrs_0.3.4              pillar_1.4.6             lifecycle_0.2.0         
 [88] BiocManager_1.30.10      data.table_1.13.2        bitops_1.0-6            
 [91] httpuv_1.5.4             R6_2.5.0                 latticeExtra_0.6-29     
 [94] promises_1.1.1           gridExtra_2.3            dichromat_2.0-0         
 [97] assertthat_0.2.1         openssl_1.4.3            rprojroot_1.3-2         
[100] withr_2.3.0              GenomicAlignments_1.26.0 GenomeInfoDbData_1.2.4  
[103] mgcv_1.8-33              hms_0.5.3                rpart_4.1-15            
[106] rmarkdown_2.5            git2r_0.27.1             biovizBase_1.38.0       
[109] lubridate_1.7.9          base64enc_0.1-3         </code></pre>
</div>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
